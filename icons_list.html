<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Web Atlas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="dist/css/webAtlas-icons.css" />
    <link rel="stylesheet" type="text/css" href="dist/css/font-face/webAtlas-icons.css" />
    <link rel="stylesheet" type="text/css" href="dist/css/font-face/webAtlas-alphanumeric.css" />
    
    <style>
        html {
            height: 100%;
            background:
                radial-gradient(ellipse farthest-corner at 50% 150%, rgba(0, 0, 0, 0) 0%, #313138 100%),
                center url(icons_list_background.png),
                #8d8d8d;
            background-size:
                auto,
                400px,
                auto;
            background-attachment: fixed;
        }
        body {
            height: 100%;
            margin: 0;
            padding: 8px;
            padding-top: 0;
            box-sizing: border-box;
            font-family: "WebAtlas";
        }
        h1, h2, h3 {
            text-align: center;
        }
        h1 {
            font-family: 'WebAtlas';
            font-size: 25px;
            color: #e7c710;
        }
        h2 {
            font-family: 'WebAtlas-Light';
            font-size: 25px;
            margin: 12px;
            margin-top: 30px;
            color: #41c3ff;
            animation: flipInX .5s;
        }
        img {
            max-width: 100%;
        }
        select {
            width: 180px;
            padding: 3px 10px;
            border-radius: 10px;
            color: white;
            font-family: webAtlas;
            font-size: 1.2em;
            background: none;
            border: 2px solid white;
            margin: 20px auto;
            display: block;
            outline: none;
        }
        select option {
            color: white;
            background-color: rgb(60, 60, 60);
        }
        #header_image {
            margin-bottom: 15px;
        }
        #main-col {
            width: 400px;
            max-width: 92%;
            margin: auto;
            margin-bottom: 50px;
            color: #ffffff;
            padding: 10px;
            border: 1px solid rgba(0, 0, 0, .4);
            background-color: rgba(28, 28, 28, .8);
            border-radius: 4px;
            box-shadow: 0px 0px 3px black, inset 0px 1px 0px rgba(255, 255, 255, .2);
            transition: width .3s;
        }
        #main-col.block {
            width: 590px;
        }
        #topRightCorner {
            width: 230px;
            height: 60px;
            background: rgba(0, 0, 0, 0.5);
            border-bottom-left-radius: 6px;
            box-shadow: 0 0 6px rgba(0, 0, 0, 0.8);
            position: fixed;
            top: 0;
            right: 0;
        }
        #arrowUp {
            width: 40px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            font-size: 22px;
            border-radius: 100%;
            opacity: .0;
            cursor: default;
            transition: .5s;
            position: fixed;
            right: 30px;
            bottom: 30px;
        }
        #switchDisplayMode {
            width: 33px;
            height: 33px;
            line-height: 33px;
            text-align: center;
            font-size: 19px;
            border-radius: 4px;
            cursor: pointer;
            transition: .5s;
            position: fixed;
            top: 13px;
            right: 18px;
        }
        #arrowUp:hover, #switchDisplayMode:hover {
            background-color: rgba(50, 132, 255, 0.5);
        }
        #search {
            color: white;
            position: fixed;
            right: 76px;
            top: 18px;
        }
        #search .icon {
            line-height: 26px;
            font-size: 25px;
            vertical-align: bottom;
        }
        #search_input {
            color: white;
            width: 100px;
            font-size: 16px;
            border: none;
            border-bottom: 2px solid white;
            background: none;
            outline: none;
        }
        .glass {
            text-shadow: 1px 1px 0 black;
            background-color: rgba(0, 0, 0, .5);
            border: 1px solid #111;
            border-bottom-color: rgb(17, 17, 17);
            border-bottom-color: black;
            box-shadow: inset 0 1px rgba(255,255,255,0.1),inset 0 -1px 3px rgba(0,0,0,0.3),inset 0 0 0 1px rgba(255,255,255,0.1),0 1px 2px rgba(0,0,0,0.15);
        }
        #gianteIcon {
            font-family: 'WebAtlas';
            font-size: 150px;
            text-shadow: 3px 3px 8px rgba(0, 0, 0, 0.8);
            z-index: -1;
            position: fixed;
            top: 150px;
            left: 100px;
        }
        .block .item {
            width: 33%;
            line-height: 20px;
            padding: 10px 5px;
            margin-bottom: 0px;
            vertical-align: top;
            display: inline-block;
        }
        .block .item .icon {
            font-size: 22px;
            vertical-align: top;
        }
        .icon {
            color: #ddd;
        }
        .info {
            font-family: 'WebAtlas-Light';
            font-size: 19px;
            text-align:center;
            color: transparent;
            color: #16b5ff;
            background-clip: text;
        }
        .item {
            box-sizing: border-box;
            line-height: 13px;
            padding: 4px 10px;
            margin-bottom: 4px;
            font-size: 13px;
            text-shadow: 0 1px rgba(0,0,0,0.8);
            background: #464a4f;
                background-image: none;
                background-clip: border-box;
            background-clip: padding-box;
            border: 1px solid #111;
                border-bottom-color: rgb(17, 17, 17);
            border-bottom-color: black;
            border-radius: 3px;
            cursor: pointer;
            box-shadow: inset 0 1px rgba(255,255,255,0.1),inset 0 -1px 3px rgba(0,0,0,0.3),inset 0 0 0 1px rgba(255,255,255,0.1),0 1px 2px rgba(0,0,0,0.15);
            background-image: linear-gradient(to bottom, rgba(255,255,255,0.08),rgba(255,255,255,0) 50%,rgba(0,0,0,0) 51%,rgba(0,0,0,0.25));
            animation: flipInX .5s;
        }
        .item:active {
            background: #393d40;
            background-image: none;
            box-shadow: inset 0 -1px 18px rgba(0,0,0,0.8),inset 0 0 0 1px rgba(255,255,255,0.1);
            background-image: linear-gradient(to bottom, rgba(0,0,0,0.1),transparent 50%,rgba(255,255,255,0.07));
        }

        @keyframes flipInX {
            0%   {transform: rotateX(90deg);}
            100% {transform: rotateX(0deg);}
        }
    </style>
</head>
<body>
    <input type="text" id="inputClipboard" style="display:none" />

    <div align="center">
        <img id="header_image" alt="font webatlas" src="font_webatlas_header.png" width="374">
    </div>

    <div id="gianteIcon"></div>

    <div id="topRightCorner"></div>
    <label id="search" for="search_input">
        <div class="icon div magnify"></div>
        <input type="text" id="search_input">
    </label>
    <div id="switchDisplayMode" class="glass icon menu"></div>
    <div id="arrowUp" class="glass icon arrow-up"></div>
    
    <div id="main-col" class="block">
        <h1>List of icons:</h1>

        <div class="info icon-first circle-info">Clic on an item to copy the className on clipboard.</div>

        <select id="select_font" autocomplete="off"></select>

        <div id="divIcons"></div>
    </div>

<script>
    var divIcons = document.getElementById('divIcons');
    var main_col = document.getElementById('main-col');
    var gianteIcon = document.getElementById('gianteIcon');
    var arrowUp = document.getElementById('arrowUp');
    var switchDisplayMode = document.getElementById('switchDisplayMode');
    var inputClipboard = document.getElementById('inputClipboard');
    var select_font = document.getElementById('select_font');
    var search_input = document.getElementById('search_input');

    var TIME_INTERVAL = 10;

    var iconsElements = [];
    
    var data = null;


    /* INIT */
    var xhr_getIcones = new XMLHttpRequest();

    xhr_getIcones.open("POST", "icons.json", true);
    xhr_getIcones.setRequestHeader("Content-Type", "application/json");
    xhr_getIcones.send();

    xhr_getIcones.onreadystatechange = function() {
        var xhr = this;
        
        if (xhr.readyState != xhr.DONE)
            return false;
        if (xhr.status == 200) {
            data = JSON.parse(xhr.response);
            init();
        }
    }

    function init() {
        loadList(data.icons);

        for (let i = 0; i < data.styles.length; i++) {
            const style = data.styles[i];
            let e = document.createElement('option');
            e.value = style;
            e.innerHTML = ucfirst(style);
            select_font.appendChild(e);
        }
    }

    onscroll = function() {
        if (getScrollY() === 0) {
            arrowUp.style.opacity = "0";
            arrowUp.style.cursor = "default";
        }
        else {
            arrowUp.style.opacity = "1";
            arrowUp.style.cursor = "pointer";
        }
    }

    main_col.onclick = function(e) {
        var ele = e.target;

        if (hasClass("icon", ele)) {
            ele = ele.parentElement;
        }

        if (ele.className === "item") {
            inputClipboard.style.display = 'block';
            inputClipboard.value = ele.codeIcon;
            inputClipboard.select();
            document.execCommand('copy');
            inputClipboard.blur();
            inputClipboard.style.display = 'none';
            
            gianteIcon.className = "icon " + ele.codeIcon;

            addClass(select_font.value, gianteIcon);
        }
    };

    select_font.onchange = function() {
        loadList(data.icons, this.value);
    };

    arrowUp.onclick = function() {
        if(getScrollY() !== 0) {
            window.scroll(0, 0);
        }
    }

    search_input.onkeydown = function() {
        setTimeout(function() {
            search();
        }, 1);
    }

    function search() {
        const s = search_input.value;

        if (s === "") {
            showAllIcones();
            return false;
        }

        for (let i = 0; i < iconsElements.length; i++) {
            const e = iconsElements[i];
            const iconName = e.childNodes[1].nodeValue;
            
            if (iconName.indexOf(s) !== -1)
                e.style.display = "";
            else
                e.style.display = "none";
        }
    }

    function showAllIcones() {
        for (let i = 0; i < iconsElements.length; i++) {
            iconsElements[i].style.display = "";
        }
    }


    // Functions

    function loadList(icons, style) {
        divIcons.innerHTML = "";

        for (category in icons) {
            var list = icons[category];

            var newH2 = document.createElement('h2');
            newH2.innerHTML = category;
            divIcons.appendChild(newH2);

            for (var i=0 ; i < list.length ; i++) {
                var icon = list[i];
                var newDiv = document.createElement('div');
                var newDivIcon = document.createElement('div');
                
                newDivIcon.className = "icon " + icon;
                if (style) addClass(style, newDivIcon);
                newDiv.appendChild(newDivIcon);
                newDiv.className = "item";
                newDiv.codeIcon = icon;
                newDiv.appendChild( document.createTextNode(icon) );
                
                iconsElements.push(newDiv);
                divIcons.appendChild(newDiv);
            }
        }
    }

    switchDisplayMode.onclick = function() {
        if (hasClass("menu", this)) {
            removeClass("menu", this);
            addClass("apps", this);
        }
        else {
            removeClass("apps", this);
            addClass("menu", this);
        }

        toggleClass("block", main_col)
    }

    function getScrollY() {
        return window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0; // position du scrolling MultiSupport.
    }

    function ucfirst(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
    }


    // MANIPULATION DE CLASS
    // Utile pour IE < 10 (classList n'étant pas compatible avant Internet Explorer 10)

    function hasClass(c, element) {
        if(element.className == '')
            return false;

        var classes = element.className.split(' ');
        return classes.indexOf(c) !== -1;
    }

    function addClass(c, element) {
        if(hasClass(c, element))
            return false;
        
        element.className += " " + c;
        return true;
    }

    function removeClass(c, element) {
        if(!hasClass(c, element))
            return false;
        
        var classes = element.className.split(' ');
        var newClass = "";
        var indexToRemove = classes.indexOf(c);
        
        classes.splice(indexToRemove, 1);
        
        if(classes.length > 0)
            newClass = classes[0];

        for(var i=1; i < classes.length ;i++) {
            newClass += " " + classes[i];
        }
        
        element.className = newClass;

        return true;
    }

    function toggleClass(c, element) {	/* Ajoute la class si elle n'existe pas ou Supprime la class si elle existe */
        if(!removeClass(c, element)) {
            addClass(c, element);
            return true;
        }

        return false;
    }
</script>
</body>
</html>